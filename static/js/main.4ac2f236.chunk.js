(this.webpackJsonpstandup=this.webpackJsonpstandup||[]).push([[0],{103:function(e,t,a){},104:function(e,t,a){},106:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"default",(function(){return v}));var r=a(0),i=a.n(r),c=a(29),s=a.n(c),o=(a(60),a(19)),u=a(25),l=a(5),d=a(36),m=a(24),p=a(50),f=a(51),h=a(4),b=a.n(h);a(28);function v(e,t){if(console.log("dispatch getArticles",e,t.type),"USER"===t.type){var a=[],n=b.a.auth().currentUser;return e.articles.forEach((function(e){e.user.uid&&n&&e.user.uid===n.uid&&a.push(e)})),Object.assign({},e,{articles:a})}return t.type,Object.assign({},e,t)}var g=Object(m.c)(Object(d.a)(Object(d.a)({},n),{},{routing:p.routerReducer})),y=Object(m.d)(g,Object(m.a)(f.a)),E=a(8),O=a(9),j=a(15),k=a(11),N=a(10),C=a(53),_=a.n(C),I=(a(83),a(84),a(85),a(86),a(28)),U=function(){function e(t){Object(E.a)(this,e),b.a.apps&&b.a.apps.length>0?this.firebaseApp=b.a.apps[0]:this.firebaseApp=b.a.initializeApp(t)}return Object(O.a)(e,[{key:"getFirebaseApp",value:function(){return this.firebaseApp}},{key:"insert",value:function(e){return b.a.database().ref().child("posts").push(e)}},{key:"update",value:function(e,t){var a={};return a["/posts/"+e]=t,a["/user-posts/genji/"+e]=t,b.a.database().ref().update(a)}},{key:"remove",value:function(e){return new Promise((function(t){b.a.database().ref("/posts/").child(e).remove(),b.a.database().ref("/user-posts/genji/").child(e).remove(),t(e)}))}},{key:"off",value:function(){return b.a.database().ref().off()}},{key:"newKey",value:function(){return b.a.database().ref().child("posts").push().key}},{key:"list",value:function(e,t){b.a.database().ref("posts").orderByKey().limitToLast(e).on("value",(function(e){t(e)}))}},{key:"getArticle",value:function(e){return new Promise((function(t){b.a.database().ref("/posts/"+e).on("value",(function(e){t(e)}))}))}},{key:"getUI",value:function(){return I.auth.AuthUI.getInstance()||new I.auth.AuthUI(b.a.auth())}},{key:"logout",value:function(){return b.a.auth().signOut()}}]),e}(),A={apiKey:"AIzaSyDfVWmfYX0DK1Xkn_OBFF2k279dHZvYUJc",authDomain:"standup-7a29b.firebaseapp.com",databaseURL:"https://standup-7a29b.firebaseio.com",storageBucket:"standup-7a29b.appspot.com",messagingSenderId:"574311250064"},S=new U(A);function w(){return console.log("action loadArticles"),function(e){S.list(25,(function(t){return e(function(e){var t=[];if(e.forEach((function(e){var a=e.val();a.key=e.key,t.push(a)})),console.log("action getArticles",t),t&&t.length>0)return{type:"ALL",articles:t.reverse()}}(t))}))}}var P=function(e){Object(k.a)(a,e);var t=Object(N.a)(a);function a(){return Object(E.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"logout",value:function(){b.a.auth().signOut()}},{key:"render",value:function(){var e=this,t=this.props.dispatch;return this.props.isPop?i.a.createElement("div",{className:"card_pop"},i.a.createElement("div",{className:"card_pop_arrow"}),i.a.createElement("div",null,i.a.createElement("a",{href:"#",onClick:function(){return t({type:"USER"})}},"\ub0b4 \uae00\ub9cc \ubcf4\uae30")),i.a.createElement("div",null,i.a.createElement("a",{href:"#",onClick:function(){return t(w())}},"\uc804\uccb4 \uae00 \ubcf4\uae30")),i.a.createElement("div",null,i.a.createElement("a",{href:"#",onClick:function(){return e.logout()}},"\ub85c\uadf8\uc544\uc6c3"))):i.a.createElement("div",null)}}]),a}(r.Component),L=Object(o.b)()(P),R=function(e){Object(k.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(E.a)(this,a),(n=t.call(this,e)).ui=new U(A).getUI(),n}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e={signInSuccessUrl:window.location.origin+"/standup",signInOptions:[b.a.auth.GoogleAuthProvider.PROVIDER_ID]};this.ui.start("#firebaseui-auth",e)}},{key:"componentWillUnmount",value:function(){this.ui.reset()}},{key:"render",value:function(){return i.a.createElement("div",{id:"firebaseui-auth"})}}]),a}(r.Component),x=function(e){Object(k.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(E.a)(this,a),(n=t.call(this,e)).state={user:void 0,isPop:!1},n}return Object(O.a)(a,[{key:"componentWillMount",value:function(){var e=this;b.a.auth().onAuthStateChanged((function(t){console.log("user",t),t?e.setState({user:t}):e.setState({user:void 0})}))}},{key:"popProfile",value:function(){this.setState({isPop:!this.state.isPop})}},{key:"render",value:function(){var e=this,t=this.state.user;return t?i.a.createElement("span",null,i.a.createElement("div",{className:"profile_name"},i.a.createElement("a",{href:"#",onClick:function(){return e.popProfile()}},t.displayName)),i.a.createElement("div",{className:"profile_img_wrap"},i.a.createElement("img",{src:t.photoURL,alt:"profiles",className:"profile_img"})),i.a.createElement(L,{isPop:this.state.isPop})):i.a.createElement("div",{className:"profile_name"},i.a.createElement(R,null))}}]),a}(r.Component),F=a(54),D=a.n(F);a(103);var V=function(e){Object(k.a)(a,e);var t=Object(N.a)(a);function a(){return Object(E.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){var e=this.props.cardInfo;return e?i.a.createElement("a",{className:"card",href:e.url,target:"_blank"},i.a.createElement("div",{className:"card_image"},void 0!==e.links.thumbnail&&i.a.createElement("img",{src:e.links.thumbnail[0].href,alt:e.meta.title,className:"width100 card_img"})),i.a.createElement("div",{className:"borderTop"},i.a.createElement("div",{className:"card_text"},i.a.createElement("p",{className:"card_title"},e.meta.title),i.a.createElement("p",{className:"card_desc"},e.meta.description),i.a.createElement("p",{className:"card_provider"},e.meta.site)))):null}}]),a}(r.Component),K=function(e){Object(k.a)(a,e);var t=Object(N.a)(a);function a(e){var n;return Object(E.a)(this,a),(n=t.call(this,e)).handleSubmit=n.handleSubmit.bind(Object(j.a)(n)),n.onPaste=n.onPaste.bind(Object(j.a)(n)),n.editorChange=n.editorChange.bind(Object(j.a)(n)),n.getCard=n.getCard.bind(Object(j.a)(n)),n.hasValue=n.hasValue.bind(Object(j.a)(n)),n.detectURL=n.detectURL.bind(Object(j.a)(n)),n.getArticle=n.getArticle.bind(Object(j.a)(n)),n.getForcedState=n.getForcedState.bind(Object(j.a)(n)),n.state={embedlyUrl:void 0,content:void 0},n}return Object(O.a)(a,[{key:"getForcedState",value:function(e,t){return new Promise((function(a){var n;e?(n=e,D.a.get("https://iframe.ly/api/iframely",{params:{url:n,api_key:"0bf29cffabe2e8590d76f8"}})).then((function(n){var r=Object.assign({},n.data);a({embedlyUrl:e,content:t,cardInfo:r})})).catch((function(e){a({embedlyUrl:void 0,content:void 0,cardInfo:void 0})})):a({content:t})}))}},{key:"handleSubmit",value:function(e){this.hasValue(this.state.content)&&(e.preventDefault(),this.props.submit(this.getArticle()),this.setState({embedlyUrl:void 0,content:void 0,cardInfo:void 0}))}},{key:"onPaste",value:function(e){var t=this,a=e.currentTarget.textContent;e.clipboardData.items[0].getAsString((function(e){var n=t.detectURL(e);n&&t.getForcedState(n,a+e).then((function(e){t.setState(e)}))}))}},{key:"editorChange",value:function(e){var t=this,a=this.detectURL(e.currentTarget.textContent);this.state.embedlyUrl||32!==e.keyCode&&13!==e.keyCode||!a||this.getForcedState(a,e.currentTarget.textContent).then((function(e){return t.setState(e)}))}},{key:"getArticle",value:function(){var e={},t=b.a.auth().currentUser;return e.user={email:t.email,displayName:t.displayName,uid:t.uid},e.content=this.state.content,this.state.embedlyUrl&&(e.cardInfo=this.state.cardInfo),e}},{key:"detectURL",value:function(e){var t=e.match(/(https?:\/\/[^\s]+)/g)||e.match(/(www.[^\s]+)/g);return null!==t&&t.length>0?t[0]:void 0}},{key:"getCard",value:function(e){return e?i.a.createElement("div",null,e):i.a.createElement("div",null)}},{key:"hasValue",value:function(e){return!(!e||"string"!==typeof e)&&(!!e&&""!==e.trim())}},{key:"render",value:function(){return i.a.createElement("div",{className:"wrapEditor"},i.a.createElement("div",{className:"editor_header"},i.a.createElement("div",{className:"today_title"},"\ubb34\uc5c7\uc744 \uacf5\uc720\ud560\uae4c\uc694?"),i.a.createElement(x,null)),i.a.createElement("div",{className:"textEditor"},i.a.createElement("div",{className:"innerEdit",contentEditable:"true",placeholder:"\uae00\uc4f0\uae30...",onPaste:this.onPaste,onKeyUp:this.editorChange,dangerouslySetInnerHTML:{__html:this.state.content}}),i.a.createElement(V,{cardInfo:this.state.cardInfo})),i.a.createElement("div",{className:"actionBar"},i.a.createElement("button",{className:"upload",disabled:!this.hasValue(this.state.content),onClick:this.handleSubmit},i.a.createElement("span",null,"\uc2a4\ud0e0\ub4dc\uc5c5!"))))}}]),a}(r.Component),T=(a(104),function(e){Object(k.a)(a,e);var t=Object(N.a)(a);function a(){return Object(E.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"componentWillMount",value:function(){(0,this.props.dispatch)(w())}},{key:"createCard",value:function(e,t){return i.a.createElement("li",{className:"list_row",key:e.key},i.a.createElement("pre",{className:"common_margin grey_text"},e.content),e.cardInfo?i.a.createElement(V,{cardInfo:e.cardInfo}):"")}},{key:"render",value:function(){return this.props.articles&&this.props.articles.length>0?i.a.createElement("ul",null,this.props.articles.map(this.createCard)):i.a.createElement("div",{key:"015b"})}}]),a}(r.Component)),B=Object(o.b)((function(e){return console.log("CardList get state",e),{articles:e.default.articles}}))(T),M=function(e){Object(k.a)(a,e);var t=Object(N.a)(a);function a(){var e;return Object(E.a)(this,a),(e=t.call(this)).submit=e.submit.bind(Object(j.a)(e)),e}return Object(O.a)(a,[{key:"submit",value:function(e){var t;e&&((0,this.props.dispatch)((t=e,function(e){S.update(S.newKey(),t)})),this.forceUpdate())}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("div",{className:"App-header"},i.a.createElement(u.b,{to:"/standup"},i.a.createElement("img",{src:_.a,className:"App-logo",alt:"logo"}))),i.a.createElement(K,{submit:this.submit}),i.a.createElement(B,{cardInfo:this.cardInfo}))}}]),a}(r.Component),W=Object(o.b)()(M),J=function(e){Object(k.a)(a,e);var t=Object(N.a)(a);function a(){return Object(E.a)(this,a),t.apply(this,arguments)}return Object(O.a)(a,[{key:"render",value:function(){return i.a.createElement("div",null,"Not Found!")}}]),a}(r.Component);function z(){return i.a.createElement(o.a,{store:y},i.a.createElement(u.a,null,i.a.createElement(l.c,null,i.a.createElement(l.a,{exact:!0,path:"/standup"},i.a.createElement(W,null)),i.a.createElement(l.a,null,i.a.createElement(J,null)))))}s.a.render(i.a.createElement(z,null),document.getElementById("root"))},53:function(e,t,a){e.exports=a.p+"static/media/stand_up_logo.190ee485.png"},55:function(e,t,a){e.exports=a(106)},60:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){}},[[55,1,2]]]);
//# sourceMappingURL=main.4ac2f236.chunk.js.map